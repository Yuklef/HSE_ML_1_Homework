Мной был проанализирован датасет для оценки стоимости автомобилей.



Для начала был проведён первичный анализ данных, включающий в себя вывод основных статистик, обработку некорректных типов данных, приведение части признаков к числовому виду, а также поиск дубликатов и заполнение пропущенных значений медианами. Это позволило подготовить данные для построения графиков и последующего обучения моделей.



Краткий вывод по EDA: Было найдено 62 полных дубликата, 95 пустых значений и 1159 неявных дубликатов.



По результатам анализа графиков были сделаны следующие выводы.



Pairplot по df\_train: Из графиков видно наличие связей признаков с целевой переменной, а также корреляции как между самими признаками, так и с целевой переменной. Можно отметить, что на стоимость автомобиля заметно влияют год продажи, мощность двигателя и его объём. Между некоторыми признаками наблюдается линейная зависимость, например между мощностью и объёмом двигателя, а также между ценой автомобиля и его мощностью.



Pairplot по df\_test: В целом выводы, сделанные ранее, применимы и к тестовым данным, однако с некоторыми оговорками. В тестовой выборке наблюдается более выраженная линейная зависимость между объёмом двигателя и его мощностью, а также менее явная зависимость между ценой автомобиля и годом продажи.



Heatmap df\_train: Выдвинутые ранее гипотезы подтверждаются: наиболее скоррелированными признаками оказались selling\_price и max\_power (0.69). Наименее скоррелированными, в свою очередь, являются год выпуска и объём двигателя (0.0028), а также количество мест и год выпуска (0.041). Кроме того, можно сделать вывод, что чем меньше год выпуска автомобиля, тем больший пробег он, в среднем, имеет к моменту продажи.



Часть 2.



На данном этапе было проведено обучение моделей, подбор гиперпараметров и использование различных видов регуляризации.



Для начала была построена модель обычной линейной регрессии.

Ее показатели Оказались равны

y\_train MSE = 116873067751.52167

y\_train R2 = 0.5922629595849873

y\_test MSE = 233297548204.61295
y\_test R2 = 0.5941441219017094



На данном этапе значение R² на тестовой выборке оказалось выше, чем на обучающей, что свидетельствует об отсутствии переобучения. Тем не менее модель недостаточно точно определяет стоимость автомобилей, поэтому были предприняты дальнейшие попытки улучшения качества.



Далее была выполнена стандартизация признаков, после чего были повторно рассчитаны метрики качества:

y\_train MSE = 116873067761.63504

y\_train R2 = 0.5922629595497046

y\_test MSE = 233298219170.7602
y\_test R2 = 0.5941429546560313



Результаты остались практически неизменными, что указывает на незначительное влияние стандартизации на качество линейной регрессии в данном случае.



Затем была обучена Lasso-регрессия. При использовании параметров по умолчанию модель не занулила ни один из признаков и не привела к улучшению качества:



Далее обучаем лассо регрессию, она также не сильно помогла, с настройкой по умолчанию не занулила никаких признаков



y\_test MSE 233298219170.7602

y\_test R2 0.5941429546560313

y\_train MSE 116873067761.63504

y\_train R2 0.5922629595497046





Далее с помощью класса GridSearchCV были подобраны значения гиперпараметра alpha из набора \[0.001, 0.01, 0.05, 0.1, 0.5, 10, 10000]. Лучшим значением оказалось alpha = 10000, при этом часть коэффициентов модели была занулена. Однако качество модели при этом ухудшилось:



y\_test MSE = 240512206991.89523

y\_test R2 = 0.5815931469779442

y\_train MSE = 117735529384.66124

y\_train R2 = 0.5892540751556381



Аналогичным образом была обучена ElasticNet-регрессия. В данном случае лучшим значением гиперпараметра alpha оказалось 0.1. Однако показатели качества также ухудшились по сравнению с базовой линейной регрессией:



y\_test MSE = 239622525215.91724

y\_test R2 = 0.5831408811105845

y\_train MSE = 117200720433.56126

y\_train R2 = 0.5911198721532199



Часть 3.



На заключительном этапе в модель были добавлены категориальные признаки, ранее не учитывавшиеся. Для этого из столбца name были выделены марки автомобилей, после чего все категориальные признаки были закодированы с использованием метода get\_dummies.



После этого была обучена модель Ridge-регрессии с использованием ранее рассмотренных значений коэффициента регуляризации. Наилучшее качество показала модель с параметром alpha = 0.5.



Добавление категориальных признаков привело к существенному улучшению качества модели как на обучающей, так и на тестовой выборках:



y\_test MSE = 125009543904.63867

y\_test R2 = 0.7825272549903259

y\_train MSE = 65165737066.28839

y\_train R2 = 0.7726551952554067



Расчёт бизнес-метрики показал, что ни одна из моделей не обеспечивает высокой точности определения стоимости автомобилей. Тем не менее лучшая модель, учитывающая категориальные признаки, корректно определяет стоимость в 25.7% случаев, тогда как остальные модели показывают результат около 22.7%.

Приложение создавалось строго по заданию и с большой помощью кода Гордея. Экспериментировать не стал из за приблежения жесткого дедлайна по этому заданию)

